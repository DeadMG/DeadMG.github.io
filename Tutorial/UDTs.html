<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../css/codepuppy.css">
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-35434966-2']);
        _gaq.push(['_trackPageview']);
        
        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
    
<title>User Defined Types</title>

    <script type="text/javascript">
    function escapeRegExp(string) {
        return string.replace(/([.*+?^=!:()|\[\]\/\\])/g, "\\$1");
    }
    function replaceAll(find, replace, str) {
      return str.replace(new RegExp(escapeRegExp(find), 'g'), replace);
    }
    // http://stackoverflow.com/questions/5251520/how-do-i-escape-some-html-in-javascript
    function escapeHTML( string )
    {
        var pre = document.createElement('pre');
        var text = document.createTextNode( string );
        pre.appendChild(text);
        return pre.innerHTML;
    }
    function enableUI(val) {
        document.getElementById("compile").disabled = !val;
    	document.getElementById("WideSource").readOnly = !val;
    	document.getElementById("CPPSource").readOnly = !val;
        document.getElementById("selector").disabled = !val;
    }
    function compile() {
        enableUI(false);
        var http = new XMLHttpRequest();
    	var widesrc = document.getElementById('WideSource').value;
    	var cppsrc = document.getElementById('CPPSource').value;
        http.open("POST", "http://coliru.stacked-crooked.com/share", true);
    	http.onreadystatechange = function() {
            if (http.readyState == 4) {
                if (http.status == 200) {
                    var location = "/Archive2/" + http.responseText.substr(0, 2) + "/" + http.responseText.substr(2, http.responseText.length).trim() + "/main.cpp";
                  	var using = 'using cplusplus := cpp("' + location + '");';
    		        var nestedhttp = new XMLHttpRequest();
                    nestedhttp.open("POST", "http://coliru.stacked-crooked.com/compile", true);
    		        nestedhttp.onreadystatechange = function() {
                        if (nestedhttp.readyState == 4) {
                            if (nestedhttp.status == 200) {
    						    enableUI(true);
                                var response = nestedhttp.responseText;
                                response = replaceAll("'x86_64' is not a recognized processor for this target (ignoring processor)", "", nestedhttp.responseText)
                                response = response.trim()
                                response = escapeHTML(response)
                                lines = response.split('\n').length
                                response = replaceAll("\n", "</br>", response)
                                document.getElementById('result').innerHTML = response;
    		            	}
    		        	}
    	            }
                    nestedhttp.send(JSON.stringify({ "cmd": "/usr/local/bin/Wide/CLI main.cpp && g++ a.o && ./a.out", "src": widesrc + using }));		
    		    }
    		}
    	}
        http.send(JSON.stringify({ "cmd": "", "src": cppsrc }));
    }
    function setcode(widesrc, cppsrc) {
        linecount = Math.max(Math.max(widesrc.split('\n').length, cppsrc.split('\n').length) - 1, 1)
        document.getElementById('WideSource').rows = linecount;
        document.getElementById('CPPSource').rows = linecount;
        document.getElementById('WideSource').value = widesrc;
        document.getElementById('CPPSource').value = cppsrc;
    }
    function init() {
        
setcode('type t {\n    var := std.string;\n    var2 := "World!";\n}\nMain() {\n    local := t();\n    local.var = "Hello, ";\n    std.cout << local.var << local.var2;\n}', '') 

    }
    $(init)
    </script>    
    
<script type="text/javascript">
function constructor_example() {
    setcode('type t {\n    type(arg := std.string) : var := arg {}\n    var := std.string;\n    ~type() { std.cout << ", World!"; }\n}\nMain() {\n    local := t("Hello");\n    std.cout << local.var;\n}', '')
}
function member_function_example() {
    setcode('type t {\n    var := "Hello, World!";\n    f() { return var; }\n}\nMain() {\n    local := t().f;\n    std.cout << local();\n}', '')
}
function ref_qualifier_example() {
    setcode('type t {\n    f(this := t.lvalue) { return "Hello,"; }\n    f(this := t.rvalue) { return " World!"; }\n}\nMain() {\n    local := t();\n    std.cout << local.f() << t().f();\n}', '')
}
function base_example() {
    setcode(
        'type t : cplusplus.base {\n    g() { return "Hello, World!"; }\n}\nMain() {\n    std.cout << cplusplus.f(t());\n}', 
        '#include <string>\nstruct base { virtual std::string g() = 0; };\nstd::string f(base&& arg) { return arg.g(); }'
    )
}
function delegating_example() {
    setcode(
        'type t {\n    local := std.string;\n    type() : type := "Hello" {}\n    type(arg := std.string) : local := arg {}\n}\n
    )
}
</script>



</head>
<body>
    <nav class="navbar navbar-inverse" style="margin-bottom: 0;" role="navigation">
        <div class="container"style="padding:0px;">
            <p class="navbar-text navbar-right"><a class="navbar-link" href="../index.html">Home</a></p>
            <p class="navbar-text navbar-right"><a class="navbar-link" href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=QVSUDSKW22LEN&lc=GB&item_number=CodePuppy&currency_code=GBP&bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted">Donate</a></p>
            <p class="navbar-text navbar-right"><a class="navbar-link" href="http://github.com/DeadMG/Wide">Source</a></p>
            <p class="navbar-text navbar-right"><a class="navbar-link" href="http://chat.stackoverflow.com/rooms/10/loungec">Chat</a></p>
            <p class="navbar-text navbar-right"><a class="navbar-link" href="http://cpp-thenewoldthing.blogspot.co.uk/">Blog</a></p>
            <p class="navbar-text navbar-right"><a class="navbar-link" href="https://trello.com/b/xlk0vyH2/wide">Trello</a></p>
            <ul class="nav navbar-nav navbar-left">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="HelloWorld.html">Hello World!</a></li>
                        <li><a href="LocalVariables.html">Local Variables</a></li>
                        <li><a href="Functions.html">Functions</a></li>
                        <li><a href="OverloadSet.html">Overload Sets</a></li>
                        <li><a href="CPPUsing.html">cpp</a></li>
                        <li><a href="ExportedFunctions.html">Exported Functions</a></li>
                        <li><a href="UDTs.html">User Defined Types</a></li>
                        <li><a href="Templates.html">Templates</a></li>
                        <li><a href="Tuples.html">Tuples</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li class="dropdown-submenu">
                            <a href="../Reference/Implementation.html">Implementation</a>
                            <ul class="dropdown-menu">                            
                                        <li class="dropdown-submenu">
                                        <a href="../Reference/Implementation/Lexer.html">Lexer</a>
                                            <ul class="dropdown-menu">       
                                                <li><a href="../Reference/Implementation/Lexer/lexerh.html">Lexer.h</a></li>                                            
                                                <li><a href="../Reference/Implementation/Lexer/tokenh.html">Token.h</a></li>                                            
                                                <li><a href="../Reference/Implementation/Lexer/lexercpp.html">Lexer.cpp</a></li>                                            
                                            </ul>
                                        </li>        
                                        <li class="dropdown-submenu">
                                        <a href="../Reference/Implementation/Parser.html">Parser</a>
                                            <ul class="dropdown-menu">       
                                                <li><a href="../Reference/Implementation/Parser/ASTh.html">AST.h</a></li>                                            
                                            </ul>
                                        </li>        
                                        <li><a href="../Reference/Implementation/Analyzer.html">Analyzer</a></li>
                                        <li><a href="../Reference/Implementation/CAPI.html">CAPI</a></li>
                                        <li><a href="../Reference/Implementation/CLI.html">CLI</a></li>
                                        <li class="dropdown-submenu">
                                        <a href="../Reference/Implementation/Util.html">Util</a>
                                            <ul class="dropdown-menu">       
                                                <li><a href="../Reference/Implementation/Util/Ranges.html">Ranges</a></li>                                            
                                            </ul>
                                        </li>        
                                        <li><a href="../Reference/Implementation/Building.html">Building</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="../Reference/Syntax.html">Syntax</a>
                            <ul class="dropdown-menu">                            
                                        <li><a href="../Reference/Syntax/Lexical.html">Lexical</a></li>
                                        <li><a href="../Reference/Syntax/Grammar.html">Grammar</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="../Reference/Semantics.html">Semantics</a>
                            <ul class="dropdown-menu">                            
                                        <li><a href="../Reference/Semantics/Type.html">Type</a></li>
                                        <li><a href="../Reference/Semantics/AggregateType.html">AggregateType</a></li>
                                        <li><a href="../Reference/Semantics/MetaType.html">MetaType</a></li>
                                        <li><a href="../Reference/Semantics/PrimitiveType.html">PrimitiveType</a></li>
                                        <li><a href="../Reference/Semantics/OverloadSet.html">OverloadSet</a></li>
                                        <li><a href="../Reference/Semantics/CPPNamespace.html">CPPNamespace</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu">
                            <a href="../Reference/Library.html">Library</a>
                            <ul class="dropdown-menu">                            
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>            
        </div>
    </nav>
    


<div class="jumbotron">
    <div class="container">
        <h1>User Defined Types</h1>
    </div>
</div>
<div class="container" style="padding:0px;">
    

<div class="form-group">
    <div class="row">
        <div class="col-md-6"><div class="input-group"><span class="input-group-addon">Wide</span><textarea class="form-control" rows="3" id="WideSource" autocomplete=false></textarea></div></div>
        <div class="col-md-6"><div class="input-group"><span class="input-group-addon">C++</span><textarea class="form-control" rows="3" id="CPPSource" autocomplete=false></textarea></div></div>
    </div>
    <div class="row">
	    <div class="col-md-12">
	        <div class="input-group">
                <div class="input-group-btn">
                    <button type="button" class="btn btn-default" id="compile" onclick="compile()">Compile</button>
                </div>
		        <label class="form-control" id="result" style="height:auto;max-height:120px;min-height:34px;overflow:auto;"></label>		
                <div class="input-group-btn">
                    <button type="button" class="btn btn-default dropdown-toggle" id="selector" data-toggle="dropdown">Examples <span class="caret"></span></button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="#" onclick="init()">User Defined Types</a></li>
                        
<li><a href="#" onclick="member_function_example()">Member Functions</a></li>
<li><a href="#" onclick="ref_qualifier_example()">Explicit <code>this</code></a></li>
<li><a href="#" onclick="constructor_example()">Constructor and destructor</a></li>
<li><a href="#" onclick="delegating_example()">Delegating constructors</a></li>
<li><a href="#" onclick="base_example()">C++ Base</a></li>

                    </ul>
                </div>    
	     	</div>
		</div>
	</div>
</div>




<div class="row">
    <div class="col-md-12">
        <p>A Wide user-defined type is introduced with the <code>type</code> keyword. Member variables are defined by initializing them to a type. They can also be initialized to values for a non-static data member initializer. In 
        this case Wide infers the type per the same rules for function locals.</p>
        <p>Wide types can define member functions. Like C++ types bound member functions are overload sets, which are objects in their own right. Wide member functions can take an explicit <code>this</code> argument. This provides
        for lvalue/rvalue overloading for member functions.</p>
        <p>Wide types can define constructors and destructors as in C++, but Wide uses the <code>type</code> keyword again, rather than the type name. Wide constructor initializer lists use <code>expression := expression</code> to 
        initialize members. Wide will not implicitly define a copy or move constructor or assignment operator, or destructor, if any of the five are defined as non-defaulted. Also note that unlike C++, if you do not define a move 
        constructor, Wide will not pick the copy constructor as a move constructor. Wide also supports delegating constructors. Inheriting constructors may be implemented later.</p>
        <p>Wide types can have base classes and they can inherit from C++ types. They can also define dynamic member functions that override virtual functions from C++. Wide defines the constructor initializer as an expression as 
        Wide type references are expressions, such as <code>cplusplus.base</code>. Currently, there is no equivalent to virtual inheritance, and many operations on types that include virtual inheritance will crash the compiler.</p>
        <p>Like in C++, you can default all of the five special member functions- copy constructor, move constructor, move assignment operator, copy assignment operator, and destructor. Wide follows the Rule of Zero- if you define 
        any of these functions as non-defaulted, Wide does not generate any that were not explicitly defaulted (except destructor). This is referred to as a <code>complex</code> type.</p>
	</div>
</div>

    <ul class="pager"><li class="previous"><a href="ExportedFunctions.html">Exported Functions</a></li><li class="next"><a href="Templates.html">Templates</a></li></ul>
</div>

    <div class="container">
        <div class="row">	
	        <footer>&copy; Puppy 2014 <a href="http://coliru.stacked-crooked.com">Compilation services provided by Coliru.</a></footer>
	    </div>
	</div>
</body>
</html>